# go-judge æ¥å£è¯¦ç»†ä½¿ç”¨æŒ‡å—

## ğŸ“‹ æ¦‚è¿°

go-judge æ˜¯ä¸€ä¸ªæ²™ç®±æœåŠ¡ï¼Œé€šè¿‡ REST API æä¾›ä»£ç æ‰§è¡ŒåŠŸèƒ½ã€‚æœ¬æ–‡æ¡£è¯¦ç»†è¯´æ˜æ¥å£å‚æ•°ã€è¿”å›å€¼å«ä¹‰ä»¥åŠå®Œæ•´çš„ä½¿ç”¨æµç¨‹ã€‚

## ğŸ”— æ ¸å¿ƒæ¥å£

### 1. ä»£ç æ‰§è¡Œæ¥å£

**æ¥å£åœ°å€**: `POST /run`
**åŠŸèƒ½**: æ‰§è¡Œç”¨æˆ·ä»£ç ï¼ˆç¼–è¯‘ã€è¿è¡Œï¼‰
**Content-Type**: `application/json`

### 2. æ–‡ä»¶ç®¡ç†æ¥å£

- `GET /file` - åˆ—å‡ºæ‰€æœ‰ç¼“å­˜æ–‡ä»¶
- `POST /file` - ä¸Šä¼ æ–‡ä»¶åˆ°ç¼“å­˜
- `GET /file/{fileId}` - ä¸‹è½½æŒ‡å®šæ–‡ä»¶
- `DELETE /file/{fileId}` - åˆ é™¤æŒ‡å®šæ–‡ä»¶

### 3. ç³»ç»Ÿä¿¡æ¯æ¥å£

- `GET /version` - è·å–ç‰ˆæœ¬ä¿¡æ¯
- `GET /config` - è·å–ç³»ç»Ÿé…ç½®

## ğŸ“ è¯·æ±‚å‚æ•°è¯¦è§£

### ä¸»è¯·æ±‚ç»“æ„

```json
{
  "cmd": [
    {
      "args": ["å‘½ä»¤", "å‚æ•°1", "å‚æ•°2"],
      "env": ["ç¯å¢ƒå˜é‡1", "ç¯å¢ƒå˜é‡2"],
      "files": [æ–‡ä»¶æè¿°ç¬¦æ•°ç»„],
      "cpuLimit": CPUæ—¶é—´é™åˆ¶(çº³ç§’),
      "clockLimit": å¢™é’Ÿæ—¶é—´é™åˆ¶(çº³ç§’),
      "memoryLimit": å†…å­˜é™åˆ¶(å­—èŠ‚),
      "stackLimit": æ ˆé™åˆ¶(å­—èŠ‚),
      "procLimit": è¿›ç¨‹æ•°é™åˆ¶,
      "cpuRate": CPUä½¿ç”¨ç‡é™åˆ¶,
      "strictMemoryLimit": ä¸¥æ ¼å†…å­˜é™åˆ¶,
      "copyIn": {è¾“å…¥æ–‡ä»¶æ˜ å°„},
      "copyOut": [è¾“å‡ºæ–‡ä»¶åˆ—è¡¨],
      "copyOutCached": [ç¼“å­˜è¾“å‡ºæ–‡ä»¶åˆ—è¡¨],
      "copyOutMax": è¾“å‡ºæ–‡ä»¶å¤§å°é™åˆ¶
    }
  ],
  "pipeMapping": [ç®¡é“æ˜ å°„é…ç½®]
}
```

### å‚æ•°è¯¦ç»†è¯´æ˜

#### cmd æ•°ç»„
- **ç±»å‹**: `Array`
- **å¿…éœ€**: âœ…
- **ä½œç”¨**: å®šä¹‰è¦æ‰§è¡Œçš„å‘½ä»¤åˆ—è¡¨ï¼Œæ”¯æŒå¤šä¸ªå‘½ä»¤ä¸²è”æ‰§è¡Œ

#### args å‚æ•°
- **ç±»å‹**: `Array<String>`
- **å¿…éœ€**: âœ…
- **ä½œç”¨**: å®šä¹‰æ‰§è¡Œçš„å‘½ä»¤å’Œå‚æ•°
- **ç¤ºä¾‹**: 
  ```json
  // Java ç¼–è¯‘
  ["args": ["/usr/bin/javac", "Main.java"]]
  
  // Java è¿è¡Œ
  ["args": ["/usr/bin/java", "Main"]]
  
  // C++ ç¼–è¯‘
  ["args": ["/usr/bin/g++", "main.cpp", "-o", "main"]]
  ```

#### env å‚å¢ƒå˜é‡
- **ç±»å‹**: `Array<String>`
- **å¿…éœ€**: âŒ
- **ä½œç”¨**: è®¾ç½®ç¨‹åºæ‰§è¡Œæ—¶çš„ç¯å¢ƒå˜é‡
- **æ ¼å¼**: `"å˜é‡å=å˜é‡å€¼"`
- **ç¤ºä¾‹**:
  ```json
  "env": [
    "PATH=/usr/bin:/bin",
    "JAVA_HOME=/usr/lib/jvm/java-17-openjdk-amd64",
    "CLASSPATH=.",
    "LANG=C.UTF-8"
  ]
  ```

#### files æ–‡ä»¶æè¿°ç¬¦
- **ç±»å‹**: `Array<Object>`
- **å¿…éœ€**: âœ…
- **ä½œç”¨**: å®šä¹‰æ ‡å‡†è¾“å…¥/è¾“å‡º/é”™è¯¯çš„å¤„ç†æ–¹å¼
- **ç»“æ„**:
  ```json
  [
    {"content": "è¾“å…¥å†…å®¹"},           // stdin - æ ‡å‡†è¾“å…¥
    {"name": "stdout", "max": 10240}, // stdout - æ ‡å‡†è¾“å‡º
    {"name": "stderr", "max": 10240}  // stderr - æ ‡å‡†é”™è¯¯
  ]
  ```

#### èµ„æºé™åˆ¶å‚æ•°

| å‚æ•° | ç±»å‹ | å•ä½ | é»˜è®¤å€¼ | ä½œç”¨ |
|------|------|------|--------|------|
| `cpuLimit` | `int64` | çº³ç§’ | 1s | CPU æ—¶é—´é™åˆ¶ |
| `clockLimit` | `int64` | çº³ç§’ | cpuLimitÃ—3 | å¢™é’Ÿæ—¶é—´é™åˆ¶ |
| `memoryLimit` | `int64` | å­—èŠ‚ | 128MB | å†…å­˜ä½¿ç”¨é™åˆ¶ |
| `stackLimit` | `int64` | å­—èŠ‚ | memoryLimit | æ ˆç©ºé—´é™åˆ¶ |
| `procLimit` | `int` | ä¸ªæ•° | 1 | æœ€å¤§è¿›ç¨‹æ•° |
| `cpuRate` | `float64` | 0-1 | 0 | CPU ä½¿ç”¨ç‡é™åˆ¶ |

**æ—¶é—´æ¢ç®—**:
- 1ç§’ = 1,000,000,000çº³ç§’
- ç¼–è¯‘å»ºè®®: 10-30ç§’
- è¿è¡Œå»ºè®®: 1-5ç§’

**å†…å­˜æ¢ç®—**:
- 1MB = 1,048,576å­—èŠ‚
- ç¼–è¯‘å»ºè®®: 256-512MB
- è¿è¡Œå»ºè®®: 64-256MB

#### copyIn è¾“å…¥æ–‡ä»¶
- **ç±»å‹**: `Object`
- **å¿…éœ€**: âŒ
- **ä½œç”¨**: å‘æ²™ç®±ä¼ å…¥æ–‡ä»¶
- **æ ¼å¼**:
  ```json
  "copyIn": {
    "æ–‡ä»¶å": {
      "content": "æ–‡ä»¶å†…å®¹"    // ç›´æ¥å†…å®¹
    },
    "æ–‡ä»¶å": {
      "fileId": "ç¼“å­˜æ–‡ä»¶ID"   // å¼•ç”¨ç¼“å­˜æ–‡ä»¶
    }
  }
  ```

#### copyOut è¾“å‡ºæ–‡ä»¶
- **ç±»å‹**: `Array<String>`
- **å¿…éœ€**: âŒ
- **ä½œç”¨**: ä»æ²™ç®±è·å–æ–‡ä»¶å†…å®¹
- **ç¤ºä¾‹**: `["stdout", "stderr", "output.txt"]`

#### copyOutCached ç¼“å­˜è¾“å‡º
- **ç±»å‹**: `Array<String>`
- **å¿…éœ€**: âŒ
- **ä½œç”¨**: ç¼“å­˜è¾“å‡ºæ–‡ä»¶ä¾›åç»­ä½¿ç”¨ï¼ˆå¦‚ç¼–è¯‘ç”Ÿæˆçš„classæ–‡ä»¶ï¼‰
- **ç¤ºä¾‹**: `["Main.class", "program.exe"]`

## ğŸ“¤ è¿”å›å€¼è¯¦è§£

### å“åº”ç»“æ„

```json
[
  {
    "status": "æ‰§è¡ŒçŠ¶æ€",
    "exitStatus": é€€å‡ºç ,
    "time": CPUæ—¶é—´(çº³ç§’),
    "memory": å†…å­˜ä½¿ç”¨(å­—èŠ‚),
    "runTime": è¿è¡Œæ—¶é—´(çº³ç§’),
    "procPeak": å³°å€¼è¿›ç¨‹æ•°,
    "files": {
      "æ–‡ä»¶å": "æ–‡ä»¶å†…å®¹"
    },
    "fileIds": {
      "æ–‡ä»¶å": "ç¼“å­˜æ–‡ä»¶ID"
    },
    "fileError": [
      {
        "name": "æ–‡ä»¶å",
        "type": "é”™è¯¯ç±»å‹",
        "message": "é”™è¯¯ä¿¡æ¯"
      }
    ]
  }
]
```

### çŠ¶æ€ç è¯¦è§£

| çŠ¶æ€ | å«ä¹‰ | è¯´æ˜ | å¤„ç†å»ºè®® |
|------|------|------|----------|
| `Accepted` | æ­£å¸¸å®Œæˆ | ç¨‹åºæˆåŠŸæ‰§è¡Œå®Œæ¯• | ç»§ç»­ä¸‹ä¸€æ­¥å¤„ç† |
| `Memory Limit Exceeded` | å†…å­˜è¶…é™ | ç¨‹åºä½¿ç”¨å†…å­˜è¶…è¿‡é™åˆ¶ | æç¤ºç”¨æˆ·ä¼˜åŒ–å†…å­˜ä½¿ç”¨ |
| `Time Limit Exceeded` | æ—¶é—´è¶…é™ | ç¨‹åºæ‰§è¡Œæ—¶é—´è¶…è¿‡é™åˆ¶ | æç¤ºç”¨æˆ·ä¼˜åŒ–ç®—æ³•æ•ˆç‡ |
| `Output Limit Exceeded` | è¾“å‡ºè¶…é™ | ç¨‹åºè¾“å‡ºè¶…è¿‡å¤§å°é™åˆ¶ | æ£€æŸ¥è¾“å‡ºå†…å®¹å’Œæ ¼å¼ |
| `File Error` | æ–‡ä»¶é”™è¯¯ | æ–‡ä»¶æ“ä½œå¤±è´¥ | æ£€æŸ¥æ–‡ä»¶è·¯å¾„å’Œæƒé™ |
| `Nonzero Exit Status` | éé›¶é€€å‡º | ç¨‹åºå¼‚å¸¸é€€å‡º | æ£€æŸ¥ç¼–è¯‘é”™è¯¯æˆ–è¿è¡Œæ—¶é”™è¯¯ |
| `Signalled` | ä¿¡å·ç»ˆæ­¢ | ç¨‹åºè¢«ä¿¡å·ç»ˆæ­¢ | æ£€æŸ¥æ®µé”™è¯¯ç­‰è¿è¡Œæ—¶é—®é¢˜ |
| `Dangerous Syscall` | å±é™©ç³»ç»Ÿè°ƒç”¨ | ç¨‹åºå°è¯•å±é™©æ“ä½œ | å®‰å…¨æ£€æŸ¥ï¼Œæ‹’ç»æ‰§è¡Œ |
| `Internal Error` | å†…éƒ¨é”™è¯¯ | æ²™ç®±å†…éƒ¨é”™è¯¯ | è”ç³»ç³»ç»Ÿç®¡ç†å‘˜ |

### è¿”å›å­—æ®µè¯´æ˜

#### status æ‰§è¡ŒçŠ¶æ€
- **ç±»å‹**: `String`
- **ä½œç”¨**: è¡¨ç¤ºç¨‹åºæ‰§è¡Œçš„æœ€ç»ˆçŠ¶æ€
- **å€¼**: è§ä¸Šè¡¨çŠ¶æ€ç 

#### exitStatus é€€å‡ºç 
- **ç±»å‹**: `int`
- **ä½œç”¨**: ç¨‹åºçš„é€€å‡ºçŠ¶æ€ç 
- **å€¼**:
  - `0`: æ­£å¸¸é€€å‡º
  - `1`: ä¸€èˆ¬é”™è¯¯ï¼ˆå¦‚ç¼–è¯‘é”™è¯¯ï¼‰
  - `9`: è¢«SIGKILLç»ˆæ­¢ï¼ˆé€šå¸¸æ˜¯è¶…æ—¶ï¼‰
  - `11`: æ®µé”™è¯¯ï¼ˆSIGSEGVï¼‰

#### time CPUæ—¶é—´
- **ç±»å‹**: `int64`
- **å•ä½**: çº³ç§’
- **ä½œç”¨**: ç¨‹åºå®é™…ä½¿ç”¨çš„CPUæ—¶é—´
- **æ¢ç®—**: `time / 1,000,000` = æ¯«ç§’

#### memory å†…å­˜ä½¿ç”¨
- **ç±»å‹**: `int64`
- **å•ä½**: å­—èŠ‚
- **ä½œç”¨**: ç¨‹åºçš„æœ€å¤§å†…å­˜ä½¿ç”¨é‡
- **æ¢ç®—**: `memory / 1024` = KB

#### runTime è¿è¡Œæ—¶é—´
- **ç±»å‹**: `int64`
- **å•ä½**: çº³ç§’
- **ä½œç”¨**: ç¨‹åºçš„å¢™é’Ÿæ—¶é—´ï¼ˆå®é™…ç»è¿‡æ—¶é—´ï¼‰

#### files è¾“å‡ºæ–‡ä»¶
- **ç±»å‹**: `Object`
- **ä½œç”¨**: åŒ…å«ç¨‹åºçš„è¾“å‡ºæ–‡ä»¶å†…å®¹
- **å¸¸è§é”®**:
  - `stdout`: æ ‡å‡†è¾“å‡º
  - `stderr`: æ ‡å‡†é”™è¯¯è¾“å‡º

#### fileIds ç¼“å­˜æ–‡ä»¶ID
- **ç±»å‹**: `Object`
- **ä½œç”¨**: ç¼“å­˜æ–‡ä»¶çš„IDæ˜ å°„ï¼Œç”¨äºåç»­å¼•ç”¨
- **ç¤ºä¾‹**: `{"Main.class": "ABC123DEF"}`

#### fileError æ–‡ä»¶é”™è¯¯
- **ç±»å‹**: `Array`
- **ä½œç”¨**: æ–‡ä»¶æ“ä½œç›¸å…³çš„é”™è¯¯ä¿¡æ¯
- **å­—æ®µ**:
  - `name`: æ–‡ä»¶å
  - `type`: é”™è¯¯ç±»å‹ï¼ˆå¦‚ CopyOutOpenï¼‰
  - `message`: è¯¦ç»†é”™è¯¯ä¿¡æ¯

## ğŸ”„ å®Œæ•´ä½¿ç”¨æµç¨‹

### Java ä»£ç æ‰§è¡Œæµç¨‹

#### æ­¥éª¤1: ç¼–è¯‘Javaä»£ç 

```json
{
  "cmd": [{
    "args": ["/usr/bin/javac", "Main.java"],
    "env": [
      "PATH=/usr/bin:/bin",
      "JAVA_HOME=/usr/lib/jvm/java-17-openjdk-amd64"
    ],
    "files": [
      {"content": ""},
      {"name": "stdout", "max": 10240},
      {"name": "stderr", "max": 10240}
    ],
    "cpuLimit": 10000000000,
    "memoryLimit": 268435456,
    "procLimit": 50,
    "copyIn": {
      "Main.java": {
        "content": "public class Main {\n    public static void main(String[] args) {\n        System.out.println(\"Hello World\");\n    }\n}"
      }
    },
    "copyOut": ["stdout", "stderr"],
    "copyOutCached": ["Main.class"]
  }]
}
```

**ç¼–è¯‘å“åº”ç¤ºä¾‹**:
```json
[{
  "status": "Accepted",
  "exitStatus": 0,
  "time": 870867000,
  "memory": 59801600,
  "runTime": 360798111,
  "files": {
    "stderr": "",
    "stdout": ""
  },
  "fileIds": {
    "Main.class": "ABC123DEF456"
  }
}]
```

#### æ­¥éª¤2: è¿è¡ŒJavaç¨‹åº

```json
{
  "cmd": [{
    "args": ["/usr/bin/java", "Main"],
    "env": [
      "PATH=/usr/bin:/bin",
      "JAVA_HOME=/usr/lib/jvm/java-17-openjdk-amd64"
    ],
    "files": [
      {"content": ""},
      {"name": "stdout", "max": 10240},
      {"name": "stderr", "max": 10240}
    ],
    "cpuLimit": 5000000000,
    "memoryLimit": 134217728,
    "procLimit": 1,
    "copyIn": {
      "Main.class": {
        "fileId": "ABC123DEF456"
      }
    },
    "copyOut": ["stdout", "stderr"]
  }]
}
```

**è¿è¡Œå“åº”ç¤ºä¾‹**:
```json
[{
  "status": "Accepted",
  "exitStatus": 0,
  "time": 123456789,
  "memory": 45678912,
  "runTime": 234567890,
  "files": {
    "stderr": "",
    "stdout": "Hello World\n"
  },
  "fileIds": {}
}]
```

#### æ­¥éª¤3: æ¸…ç†ç¼“å­˜æ–‡ä»¶

```http
DELETE /file/ABC123DEF456
```

**å“åº”**: `200 OK`

## ğŸ› ï¸ ä½¿ç”¨æ¨¡å¼

### æ¨¡å¼1: ç¼–è¯‘+è¿è¡Œåˆ†ç¦»

```mermaid
sequenceDiagram
    Client->>go-judge: POST /run (ç¼–è¯‘)
    go-judge-->>Client: è¿”å›classæ–‡ä»¶ID
    Client->>go-judge: POST /run (è¿è¡Œ, ä½¿ç”¨æ–‡ä»¶ID)
    go-judge-->>Client: è¿”å›æ‰§è¡Œç»“æœ
    Client->>go-judge: DELETE /file/{fileId}
    go-judge-->>Client: ç¡®è®¤åˆ é™¤
```

**ä¼˜åŠ¿**: 
- ç¼–è¯‘ä¸€æ¬¡ï¼Œå¤šæ¬¡è¿è¡Œ
- é€‚åˆå¤šä¸ªæµ‹è¯•ç”¨ä¾‹åœºæ™¯
- èŠ‚çœèµ„æº

### æ¨¡å¼2: ä¸€ä½“åŒ–æ‰§è¡Œ

```json
{
  "cmd": [
    {
      "args": ["/usr/bin/javac", "Main.java"],
      "copyIn": {"Main.java": {"content": "æºä»£ç "}},
      "copyOutCached": ["Main.class"]
    },
    {
      "args": ["/usr/bin/java", "Main"],
      "files": [{"content": "è¾“å…¥æ•°æ®"}, {"name": "stdout", "max": 10240}],
      "copyIn": {"Main.class": {"fileId": ""}},
      "copyOut": ["stdout"]
    }
  ],
  "pipeMapping": [
    {"in": {"index": 0, "fd": 1}, "out": {"index": 1, "fd": 0}}
  ]
}
```

**ä¼˜åŠ¿**:
- ä¸€æ¬¡è¯·æ±‚å®Œæˆ
- è‡ªåŠ¨æ–‡ä»¶ä¼ é€’
- ç®€åŒ–æµç¨‹

## âš ï¸ æ³¨æ„äº‹é¡¹

### 1. æ–‡ä»¶ç®¡ç†

- **åŠæ—¶æ¸…ç†**: ç¼“å­˜æ–‡ä»¶ä¼šå ç”¨å†…å­˜ï¼Œç”¨å®Œéœ€ç«‹å³åˆ é™¤
- **å¤§å°é™åˆ¶**: å•ä¸ªæ–‡ä»¶æœ‰å¤§å°é™åˆ¶ï¼Œé»˜è®¤64MB
- **ç”Ÿå‘½å‘¨æœŸ**: æ–‡ä»¶æœ‰TTLï¼Œè¿‡æœŸè‡ªåŠ¨åˆ é™¤

### 2. èµ„æºè®¾ç½®

- **ç¼–è¯‘èµ„æº**: é€šå¸¸éœ€è¦æ›´å¤šæ—¶é—´å’Œå†…å­˜
- **è¿è¡Œèµ„æº**: æ ¹æ®é¢˜ç›®è¦æ±‚ä¸¥æ ¼é™åˆ¶
- **è¿›ç¨‹é™åˆ¶**: ç¼–è¯‘æ—¶å¯ä»¥å¤šè¿›ç¨‹ï¼Œè¿è¡Œæ—¶å»ºè®®å•è¿›ç¨‹

### 3. é”™è¯¯å¤„ç†

```go
// Go è¯­è¨€é”™è¯¯å¤„ç†ç¤ºä¾‹
func handleJudgeResult(result JudgeResult) {
    switch result.Status {
    case "Accepted":
        // å¤„ç†æˆåŠŸ
    case "Memory Limit Exceeded":
        // å†…å­˜è¶…é™
    case "Time Limit Exceeded":
        // æ—¶é—´è¶…é™
    case "Compile Error":
        // ç¼–è¯‘é”™è¯¯
        fmt.Println("ç¼–è¯‘é”™è¯¯:", result.Files["stderr"])
    case "Runtime Error":
        // è¿è¡Œæ—¶é”™è¯¯
    default:
        // å…¶ä»–é”™è¯¯
    }
}
```

### 4. æ€§èƒ½ä¼˜åŒ–

- **è¿æ¥å¤ç”¨**: ä½¿ç”¨HTTPè¿æ¥æ± 
- **å¹¶å‘æ§åˆ¶**: é™åˆ¶åŒæ—¶è¯·æ±‚æ•°é‡
- **è¶…æ—¶è®¾ç½®**: è®¾ç½®åˆç†çš„è¯·æ±‚è¶…æ—¶
- **é‡è¯•æœºåˆ¶**: å¯¹ä¸´æ—¶å¤±è´¥è¿›è¡Œé‡è¯•

### 5. å®‰å…¨è€ƒè™‘

- **è¾“å…¥éªŒè¯**: éªŒè¯ç”¨æˆ·ä»£ç å®‰å…¨æ€§
- **èµ„æºé™åˆ¶**: ä¸¥æ ¼è®¾ç½®èµ„æºä¸Šé™
- **æ²™ç®±éš”ç¦»**: ä¾èµ–go-judgeçš„å®‰å…¨æœºåˆ¶
- **æ—¥å¿—ç›‘æ§**: è®°å½•æ‰€æœ‰æ‰§è¡Œæ—¥å¿—

## ğŸ“š å®ç”¨ç¤ºä¾‹

### ç¤ºä¾‹1: ACMç«èµ›é¢˜ç›®

```json
{
  "cmd": [{
    "args": ["/usr/bin/javac", "Main.java"],
    "env": ["PATH=/usr/bin:/bin", "JAVA_HOME=/usr/lib/jvm/java-17-openjdk-amd64"],
    "files": [{"content": ""}, {"name": "stdout", "max": 10240}, {"name": "stderr", "max": 10240}],
    "cpuLimit": 30000000000,
    "memoryLimit": 536870912,
    "procLimit": 50,
    "copyIn": {
      "Main.java": {
        "content": "import java.util.Scanner;\npublic class Main {\n    public static void main(String[] args) {\n        Scanner sc = new Scanner(System.in);\n        int a = sc.nextInt();\n        int b = sc.nextInt();\n        System.out.println(a + b);\n    }\n}"
      }
    },
    "copyOut": ["stdout", "stderr"],
    "copyOutCached": ["Main.class"]
  }]
}
```

### ç¤ºä¾‹2: æ‰¹é‡æµ‹è¯•ç”¨ä¾‹

```python
# Python å®¢æˆ·ç«¯ç¤ºä¾‹
import requests

def judge_solution(code, test_cases):
    # ç¼–è¯‘ä»£ç 
    compile_request = {
        "cmd": [{
            "args": ["/usr/bin/javac", "Main.java"],
            "env": ["PATH=/usr/bin:/bin", "JAVA_HOME=/usr/lib/jvm/java-17-openjdk-amd64"],
            "files": [{"content": ""}, {"name": "stdout", "max": 10240}, {"name": "stderr", "max": 10240}],
            "cpuLimit": 10000000000,
            "memoryLimit": 268435456,
            "procLimit": 50,
            "copyIn": {"Main.java": {"content": code}},
            "copyOut": ["stdout", "stderr"],
            "copyOutCached": ["Main.class"]
        }]
    }
    
    compile_response = requests.post("http://localhost:5050/run", json=compile_request)
    compile_result = compile_response.json()[0]
    
    if compile_result["status"] != "Accepted":
        return {"status": "Compile Error", "error": compile_result["files"]["stderr"]}
    
    class_file_id = compile_result["fileIds"]["Main.class"]
    
    # è¿è¡Œæµ‹è¯•ç”¨ä¾‹
    results = []
    for i, test_case in enumerate(test_cases):
        run_request = {
            "cmd": [{
                "args": ["/usr/bin/java", "Main"],
                "env": ["PATH=/usr/bin:/bin", "JAVA_HOME=/usr/lib/jvm/java-17-openjdk-amd64"],
                "files": [{"content": test_case["input"]}, {"name": "stdout", "max": 10240}, {"name": "stderr", "max": 10240}],
                "cpuLimit": 2000000000,
                "memoryLimit": 134217728,
                "procLimit": 1,
                "copyIn": {"Main.class": {"fileId": class_file_id}},
                "copyOut": ["stdout", "stderr"]
            }]
        }
        
        run_response = requests.post("http://localhost:5050/run", json=run_request)
        run_result = run_response.json()[0]
        
        results.append({
            "test_case": i + 1,
            "status": run_result["status"],
            "output": run_result["files"]["stdout"],
            "expected": test_case["output"],
            "time": run_result["time"] // 1000000,  # è½¬æ¢ä¸ºæ¯«ç§’
            "memory": run_result["memory"] // 1024   # è½¬æ¢ä¸ºKB
        })
    
    # æ¸…ç†ç¼“å­˜æ–‡ä»¶
    requests.delete(f"http://localhost:5050/file/{class_file_id}")
    
    return {"status": "Success", "results": results}
```

è¿™ä¸ªæ–‡æ¡£æ¶µç›–äº† go-judge æ¥å£çš„æ‰€æœ‰é‡è¦ä¿¡æ¯ï¼Œå¸®åŠ©æ‚¨ç†è§£å’Œæ­£ç¡®ä½¿ç”¨è¿™ä¸ªæ²™ç®±æœåŠ¡ã€‚





# Go-Judge æ²™ç®±å¼€å‘è€…æ¥å£æŒ‡å—

## æ¦‚è¿°

go-judge æ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„ä»£ç æ‰§è¡Œæ²™ç®±æœåŠ¡ï¼Œä¸“ä¸ºåœ¨çº¿è¯„æµ‹ç³»ç»Ÿ(OJ)è®¾è®¡ã€‚æœ¬æŒ‡å—å°†è¯¦ç»†è¯´æ˜å¦‚ä½•åœ¨å¼€å‘ä¸­ä½¿ç”¨æ²™ç®±çš„ç¼–è¯‘å’Œè¿è¡Œæ¥å£ï¼Œå¹¶ä»¥"ä¸¤æ•°ä¹‹å’Œ"ç®—æ³•é¢˜ä¸ºä¾‹è¿›è¡Œå®æˆ˜æ¼”ç¤ºã€‚

## æ ¸å¿ƒæ¥å£æ¶æ„

### åŸºç¡€ URL
```
http://localhost:5050/run
```

### ä¸¤ç§å·¥ä½œæ¨¡å¼

#### 1. æ¥å£æ¨¡å¼ (Interface Mode)
- é€‚ç”¨åœºæ™¯ï¼šæ ‡å‡† ACM/ICPC é£æ ¼é¢˜ç›®
- ç‰¹ç‚¹ï¼šé€šè¿‡æ ‡å‡†è¾“å…¥è¾“å‡ºè¿›è¡Œæ•°æ®äº¤äº’
- åˆ¤é¢˜æ–¹å¼ï¼šè¾“å‡ºæ¯”è¾ƒ

#### 2. ACM æ¨¡å¼ (ACM Mode)  
- é€‚ç”¨åœºæ™¯ï¼šå‡½æ•°è°ƒç”¨é£æ ¼é¢˜ç›®ï¼ˆå¦‚ LeetCodeï¼‰
- ç‰¹ç‚¹ï¼šé€šè¿‡å‡½æ•°æ¥å£è¿›è¡Œæ•°æ®äº¤äº’
- åˆ¤é¢˜æ–¹å¼ï¼šè¿”å›å€¼æ¯”è¾ƒ

## ç¼–è¯‘è¯·æ±‚æ¥å£

### æ¥å£å®šä¹‰
```http
POST /run
Content-Type: application/json
```

### ç¼–è¯‘è¯·æ±‚å‚æ•°ç»“æ„

```json
{
  "cmd": [
    {
      "args": ["/usr/bin/javac", "-encoding", "UTF-8", "-cp", "/w", "Main.java"],
      "env": ["PATH=/usr/bin:/bin"],
      "files": [
        {
          "content": ""
        },
        {
          "name": "stdout",
          "max": 10240
        },
        {
          "name": "stderr", 
          "max": 10240
        }
      ],
      "cpuLimit": 10000000000,
      "memoryLimit": 134217728,
      "procLimit": 50,
      "copyIn": {
        "Main.java": {
          "content": "ç”¨æˆ·æäº¤çš„Javaæºä»£ç "
        }
      },
      "copyOut": ["stdout", "stderr"],
      "copyOutCached": ["Main.class"],
      "copyOutMax": 10240
    }
  ]
}
```

### ç¼–è¯‘å‚æ•°è¯¦è§£

| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| `args` | []string | æ˜¯ | ç¼–è¯‘å‘½ä»¤å‚æ•°æ•°ç»„ |
| `env` | []string | å¦ | ç¯å¢ƒå˜é‡è®¾ç½® |
| `files` | []object | æ˜¯ | æ–‡ä»¶æè¿°ç¬¦é…ç½® |
| `cpuLimit` | int64 | æ˜¯ | CPUæ—¶é—´é™åˆ¶(çº³ç§’) |
| `memoryLimit` | int64 | æ˜¯ | å†…å­˜é™åˆ¶(å­—èŠ‚) |
| `procLimit` | int | æ˜¯ | è¿›ç¨‹æ•°é™åˆ¶ |
| `copyIn` | map | æ˜¯ | è¾“å…¥æ–‡ä»¶æ˜ å°„ |
| `copyOut` | []string | å¦ | è¾“å‡ºæ–‡ä»¶åˆ—è¡¨ |
| `copyOutCached` | []string | å¦ | ç¼“å­˜æ–‡ä»¶åˆ—è¡¨ |
| `copyOutMax` | int64 | å¦ | è¾“å‡ºæ–‡ä»¶å¤§å°é™åˆ¶ |

### ç¼–è¯‘è¿”å›ç»“æœ

```json
{
  "status": "Accepted",
  "exitStatus": 0,
  "time": 856000000,
  "memory": 12345678,
  "runTime": 856000000,
  "files": {
    "stdout": "",
    "stderr": ""
  },
  "fileIds": {
    "Main.class": "file_cache_id_here"
  }
}
```

### ç¼–è¯‘è¿”å›å‚æ•°è§£æ

| å‚æ•° | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `status` | string | æ‰§è¡ŒçŠ¶æ€ (Accepted/Compile Error/etc.) |
| `exitStatus` | int | è¿›ç¨‹é€€å‡ºç  (0è¡¨ç¤ºæˆåŠŸ) |
| `time` | int64 | å®é™…æ‰§è¡Œæ—¶é—´(çº³ç§’) |
| `memory` | int64 | å†…å­˜å³°å€¼ä½¿ç”¨é‡(å­—èŠ‚) |
| `runTime` | int64 | è¿è¡Œæ—¶é—´(çº³ç§’) |
| `files` | map | è¾“å‡ºæ–‡ä»¶å†…å®¹ |
| `fileIds` | map | ç¼“å­˜æ–‡ä»¶IDæ˜ å°„ |

## è¿è¡Œè¯·æ±‚æ¥å£

### è¿è¡Œè¯·æ±‚å‚æ•°ç»“æ„

```json
{
  "cmd": [
    {
      "args": ["/usr/bin/java", "-cp", "/w", "Main"],
      "env": ["PATH=/usr/bin:/bin"],
      "files": [
        {
          "content": "æµ‹è¯•ç”¨ä¾‹è¾“å…¥æ•°æ®"
        },
        {
          "name": "stdout",
          "max": 10240
        },
        {
          "name": "stderr",
          "max": 10240
        }
      ],
      "cpuLimit": 1000000000,
      "memoryLimit": 134217728,
      "procLimit": 50,
      "copyInCached": {
        "Main.class": "file_cache_id_here"
      },
      "copyOut": ["stdout", "stderr"],
      "copyOutMax": 10240
    }
  ]
}
```

### è¿è¡Œå‚æ•°è¯¦è§£

| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| `args` | []string | æ˜¯ | è¿è¡Œå‘½ä»¤å‚æ•°æ•°ç»„ |
| `files[0].content` | string | æ˜¯ | æ ‡å‡†è¾“å…¥æ•°æ® |
| `copyInCached` | map | å¦ | ä½¿ç”¨ç¼“å­˜çš„ç¼–è¯‘æ–‡ä»¶ |
| `cpuLimit` | int64 | æ˜¯ | CPUæ—¶é—´é™åˆ¶(çº³ç§’) |
| `memoryLimit` | int64 | æ˜¯ | å†…å­˜é™åˆ¶(å­—èŠ‚) |

### è¿è¡Œè¿”å›ç»“æœ

```json
{
  "status": "Accepted",
  "exitStatus": 0,
  "time": 123456789,
  "memory": 23456789,
  "runTime": 123456789,
  "files": {
    "stdout": "ç¨‹åºè¾“å‡ºç»“æœ",
    "stderr": ""
  }
}
```

## å®æˆ˜æ¡ˆä¾‹ï¼šä¸¤æ•°ä¹‹å’Œ

### é¢˜ç›®åˆ†æ
- **é—®é¢˜**ï¼šåœ¨æ•°ç»„ä¸­æ‰¾å‡ºä¸¤ä¸ªæ•°ä¹‹å’Œç­‰äºç›®æ ‡å€¼çš„ä¸‹æ ‡
- **è¾“å…¥**ï¼šæ•´æ•°æ•°ç»„å’Œç›®æ ‡å€¼
- **è¾“å‡º**ï¼šä¸¤ä¸ªæ•´æ•°çš„ä¸‹æ ‡æ•°ç»„
- **çº¦æŸ**ï¼šæ—¶é—´å¤æ‚åº¦ä¼˜åŒ–ï¼Œç©ºé—´å¤æ‚åº¦è€ƒè™‘

### æ¥å£æ¨¡å¼å®ç°

#### 1. Java è§£é¢˜ä»£ç 

```java
import java.util.*;

public class Main {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        // è¯»å–æ•°ç»„é•¿åº¦
        int n = scanner.nextInt();
        int[] nums = new int[n];
        
        // è¯»å–æ•°ç»„å…ƒç´ 
        for (int i = 0; i < n; i++) {
            nums[i] = scanner.nextInt();
        }
        
        // è¯»å–ç›®æ ‡å€¼
        int target = scanner.nextInt();
        
        // è°ƒç”¨è§£é¢˜æ–¹æ³•
        int[] result = twoSum(nums, target);
        
        // è¾“å‡ºç»“æœ
        System.out.println(result[0] + " " + result[1]);
        
        scanner.close();
    }
    
    public static int[] twoSum(int[] nums, int target) {
        Map<Integer, Integer> map = new HashMap<>();
        for (int i = 0; i < nums.length; i++) {
            int complement = target - nums[i];
            if (map.containsKey(complement)) {
                return new int[]{map.get(complement), i};
            }
            map.put(nums[i], i);
        }
        throw new IllegalArgumentException("No two sum solution");
    }
}
```

#### 2. æµ‹è¯•ç”¨ä¾‹æ ¼å¼

**è¾“å…¥æ ¼å¼ï¼š**
```
4
2 7 11 15
9
```

**è¾“å‡ºæ ¼å¼ï¼š**
```
0 1
```

#### 3. ç¼–è¯‘è¯·æ±‚ç¤ºä¾‹

```json
{
  "cmd": [
    {
      "args": ["/usr/bin/javac", "-encoding", "UTF-8", "-cp", "/w", "Main.java"],
      "env": ["PATH=/usr/bin:/bin"],
      "files": [
        {"content": ""},
        {"name": "stdout", "max": 10240},
        {"name": "stderr", "max": 10240}
      ],
      "cpuLimit": 10000000000,
      "memoryLimit": 134217728,
      "procLimit": 50,
      "copyIn": {
        "Main.java": {
          "content": "ä¸Šè¿°Javaä»£ç å†…å®¹"
        }
      },
      "copyOut": ["stdout", "stderr"],
      "copyOutCached": ["Main.class"],
      "copyOutMax": 10240
    }
  ]
}
```

#### 4. è¿è¡Œè¯·æ±‚ç¤ºä¾‹

```json
{
  "cmd": [
    {
      "args": ["/usr/bin/java", "-cp", "/w", "Main"],
      "env": ["PATH=/usr/bin:/bin"],
      "files": [
        {"content": "4\n2 7 11 15\n9\n"},
        {"name": "stdout", "max": 10240},
        {"name": "stderr", "max": 10240}
      ],
      "cpuLimit": 1000000000,
      "memoryLimit": 134217728,
      "procLimit": 50,
      "copyInCached": {
        "Main.class": "ç¼–è¯‘é˜¶æ®µè¿”å›çš„fileId"
      },
      "copyOut": ["stdout", "stderr"],
      "copyOutMax": 10240
    }
  ]
}
```

### ACM æ¨¡å¼å®ç°

#### 1. å‡½æ•°æ¥å£é£æ ¼ä»£ç 

```java
import java.util.*;

class Solution {
    public int[] twoSum(int[] nums, int target) {
        Map<Integer, Integer> map = new HashMap<>();
        for (int i = 0; i < nums.length; i++) {
            int complement = target - nums[i];
            if (map.containsKey(complement)) {
                return new int[]{map.get(complement), i};
            }
            map.put(nums[i], i);
        }
        return new int[0];
    }
}

public class Main {
    public static void main(String[] args) {
        Solution solution = new Solution();
        
        // æµ‹è¯•ç”¨ä¾‹ 1
        int[] nums1 = {2, 7, 11, 15};
        int target1 = 9;
        int[] result1 = solution.twoSum(nums1, target1);
        System.out.println(Arrays.toString(result1));
        
        // æµ‹è¯•ç”¨ä¾‹ 2  
        int[] nums2 = {3, 2, 4};
        int target2 = 6;
        int[] result2 = solution.twoSum(nums2, target2);
        System.out.println(Arrays.toString(result2));
        
        // æµ‹è¯•ç”¨ä¾‹ 3
        int[] nums3 = {3, 3};
        int target3 = 6;
        int[] result3 = solution.twoSum(nums3, target3);
        System.out.println(Arrays.toString(result3));
    }
}
```

## å¼€å‘è°ƒç”¨æµç¨‹

### 1. å®Œæ•´çš„åˆ¤é¢˜æµç¨‹

```python
import requests
import json

class JudgeClient:
    def __init__(self, base_url="http://localhost:5050"):
        self.base_url = base_url
    
    def compile_and_run(self, source_code, input_data, time_limit=1000, memory_limit=128):
        """
        ç¼–è¯‘å¹¶è¿è¡Œä»£ç 
        
        Args:
            source_code: Javaæºä»£ç 
            input_data: æµ‹è¯•ç”¨ä¾‹è¾“å…¥
            time_limit: æ—¶é—´é™åˆ¶(æ¯«ç§’)
            memory_limit: å†…å­˜é™åˆ¶(MB)
        
        Returns:
            ç¼–è¯‘å’Œè¿è¡Œç»“æœ
        """
        
        # æ­¥éª¤1: ç¼–è¯‘è¯·æ±‚
        compile_request = {
            "cmd": [{
                "args": ["/usr/bin/javac", "-encoding", "UTF-8", "-cp", "/w", "Main.java"],
                "env": ["PATH=/usr/bin:/bin"],
                "files": [
                    {"content": ""},
                    {"name": "stdout", "max": 10240},
                    {"name": "stderr", "max": 10240}
                ],
                "cpuLimit": 10000000000,  # 10ç§’ç¼–è¯‘æ—¶é—´
                "memoryLimit": memory_limit * 1024 * 1024,
                "procLimit": 50,
                "copyIn": {
                    "Main.java": {"content": source_code}
                },
                "copyOut": ["stdout", "stderr"],
                "copyOutCached": ["Main.class"],
                "copyOutMax": 10240
            }]
        }
        
        # å‘é€ç¼–è¯‘è¯·æ±‚
        compile_response = requests.post(f"{self.base_url}/run", 
                                       json=compile_request)
        compile_result = compile_response.json()
        
        # æ£€æŸ¥ç¼–è¯‘ç»“æœ
        if compile_result[0]["status"] != "Accepted":
            return {
                "compile_status": compile_result[0]["status"],
                "compile_error": compile_result[0]["files"].get("stderr", ""),
                "success": False
            }
        
        # è·å–ç¼–è¯‘åçš„classæ–‡ä»¶ID
        class_file_id = compile_result[0]["fileIds"]["Main.class"]
        
        # æ­¥éª¤2: è¿è¡Œè¯·æ±‚
        run_request = {
            "cmd": [{
                "args": ["/usr/bin/java", "-cp", "/w", "Main"],
                "env": ["PATH=/usr/bin:/bin"],
                "files": [
                    {"content": input_data},
                    {"name": "stdout", "max": 10240},
                    {"name": "stderr", "max": 10240}
                ],
                "cpuLimit": time_limit * 1000000,  # è½¬æ¢ä¸ºçº³ç§’
                "memoryLimit": memory_limit * 1024 * 1024,
                "procLimit": 50,
                "copyInCached": {
                    "Main.class": class_file_id
                },
                "copyOut": ["stdout", "stderr"],
                "copyOutMax": 10240
            }]
        }
        
        # å‘é€è¿è¡Œè¯·æ±‚
        run_response = requests.post(f"{self.base_url}/run", 
                                   json=run_request)
        run_result = run_response.json()
        
        return {
            "compile_status": "Accepted",
            "run_status": run_result[0]["status"],
            "output": run_result[0]["files"].get("stdout", ""),
            "error": run_result[0]["files"].get("stderr", ""),
            "time_used": run_result[0]["time"] // 1000000,  # è½¬æ¢ä¸ºæ¯«ç§’
            "memory_used": run_result[0]["memory"] // 1024,  # è½¬æ¢ä¸ºKB
            "exit_code": run_result[0]["exitStatus"],
            "success": run_result[0]["status"] == "Accepted"
        }

# ä½¿ç”¨ç¤ºä¾‹
if __name__ == "__main__":
    judge = JudgeClient()
    
    # ä¸¤æ•°ä¹‹å’Œçš„Javaä»£ç 
    java_code = """
import java.util.*;

public class Main {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        int n = scanner.nextInt();
        int[] nums = new int[n];
        for (int i = 0; i < n; i++) {
            nums[i] = scanner.nextInt();
        }
        int target = scanner.nextInt();
        
        int[] result = twoSum(nums, target);
        System.out.println(result[0] + " " + result[1]);
        scanner.close();
    }
    
    public static int[] twoSum(int[] nums, int target) {
        Map<Integer, Integer> map = new HashMap<>();
        for (int i = 0; i < nums.length; i++) {
            int complement = target - nums[i];
            if (map.containsKey(complement)) {
                return new int[]{map.get(complement), i};
            }
            map.put(nums[i], i);
        }
        throw new IllegalArgumentException("No solution");
    }
}
"""
    
    # æµ‹è¯•ç”¨ä¾‹
    test_input = "4\n2 7 11 15\n9\n"
    expected_output = "0 1"
    
    # æ‰§è¡Œåˆ¤é¢˜
    result = judge.compile_and_run(java_code, test_input)
    
    if result["success"]:
        actual_output = result["output"].strip()
        if actual_output == expected_output:
            print("âœ… æµ‹è¯•é€šè¿‡")
            print(f"è¾“å‡º: {actual_output}")
            print(f"æ—¶é—´: {result['time_used']}ms")
            print(f"å†…å­˜: {result['memory_used']}KB")
        else:
            print("âŒ è¾“å‡ºä¸åŒ¹é…")
            print(f"æœŸæœ›: {expected_output}")
            print(f"å®é™…: {actual_output}")
    else:
        print("âŒ æ‰§è¡Œå¤±è´¥")
        print(f"ç¼–è¯‘çŠ¶æ€: {result.get('compile_status')}")
        print(f"è¿è¡ŒçŠ¶æ€: {result.get('run_status')}")
        print(f"é”™è¯¯ä¿¡æ¯: {result.get('error')}")
```

### 2. æ‰¹é‡æµ‹è¯•å¤„ç†

```python
def batch_test(judge_client, source_code, test_cases):
    """
    æ‰¹é‡æµ‹è¯•ç”¨ä¾‹æ‰§è¡Œ
    
    Args:
        judge_client: JudgeClientå®ä¾‹
        source_code: æºä»£ç 
        test_cases: æµ‹è¯•ç”¨ä¾‹åˆ—è¡¨ [{"input": "...", "expected": "..."}]
    
    Returns:
        æµ‹è¯•ç»“æœç»Ÿè®¡
    """
    results = []
    passed = 0
    
    for i, test_case in enumerate(test_cases):
        print(f"æ‰§è¡Œæµ‹è¯•ç”¨ä¾‹ {i+1}...")
        
        result = judge_client.compile_and_run(
            source_code, 
            test_case["input"]
        )
        
        if result["success"]:
            actual = result["output"].strip()
            expected = test_case["expected"].strip()
            
            test_result = {
                "case_id": i + 1,
                "passed": actual == expected,
                "expected": expected,
                "actual": actual,
                "time": result["time_used"],
                "memory": result["memory_used"]
            }
            
            if test_result["passed"]:
                passed += 1
                print(f"âœ… æµ‹è¯•ç”¨ä¾‹ {i+1} é€šè¿‡")
            else:
                print(f"âŒ æµ‹è¯•ç”¨ä¾‹ {i+1} å¤±è´¥")
                print(f"  æœŸæœ›: {expected}")
                print(f"  å®é™…: {actual}")
        else:
            test_result = {
                "case_id": i + 1,
                "passed": False,
                "error": result.get("error", "è¿è¡Œé”™è¯¯")
            }
            print(f"âŒ æµ‹è¯•ç”¨ä¾‹ {i+1} æ‰§è¡Œå¤±è´¥: {test_result['error']}")
        
        results.append(test_result)
    
    print(f"\næµ‹è¯•æ€»ç»“: {passed}/{len(test_cases)} é€šè¿‡")
    return results

# ä¸¤æ•°ä¹‹å’Œæµ‹è¯•ç”¨ä¾‹
test_cases = [
    {
        "input": "4\n2 7 11 15\n9\n",
        "expected": "0 1"
    },
    {
        "input": "3\n3 2 4\n6\n", 
        "expected": "1 2"
    },
    {
        "input": "2\n3 3\n6\n",
        "expected": "0 1"
    }
]

# æ‰§è¡Œæ‰¹é‡æµ‹è¯•
judge = JudgeClient()
batch_results = batch_test(judge, java_code, test_cases)
```

## é”™è¯¯å¤„ç†å’ŒçŠ¶æ€ç 

### å¸¸è§çŠ¶æ€ç è¯´æ˜

| çŠ¶æ€ç  | å«ä¹‰ | å¤„ç†å»ºè®® |
|--------|------|----------|
| `Accepted` | æ‰§è¡ŒæˆåŠŸ | ç»§ç»­å¤„ç†è¾“å‡ºç»“æœ |
| `Compile Error` | ç¼–è¯‘é”™è¯¯ | æ£€æŸ¥æºä»£ç è¯­æ³• |
| `Runtime Error` | è¿è¡Œæ—¶é”™è¯¯ | æ£€æŸ¥é€»è¾‘é”™è¯¯å’Œå¼‚å¸¸å¤„ç† |
| `Time Limit Exceeded` | è¶…æ—¶ | ä¼˜åŒ–ç®—æ³•å¤æ‚åº¦ |
| `Memory Limit Exceeded` | å†…å­˜è¶…é™ | ä¼˜åŒ–å†…å­˜ä½¿ç”¨ |
| `Wrong Answer` | ç­”æ¡ˆé”™è¯¯ | æ£€æŸ¥ç®—æ³•é€»è¾‘ |
| `System Error` | ç³»ç»Ÿé”™è¯¯ | æ£€æŸ¥æ²™ç®±æœåŠ¡çŠ¶æ€ |

### é”™è¯¯å¤„ç†æœ€ä½³å®è·µ

```python
def handle_judge_result(result):
    """å¤„ç†åˆ¤é¢˜ç»“æœçš„é€šç”¨æ–¹æ³•"""
    
    if not result["success"]:
        # ç¼–è¯‘é”™è¯¯
        if result.get("compile_status") != "Accepted":
            return {
                "verdict": "Compile Error",
                "message": result.get("compile_error", "ç¼–è¯‘å¤±è´¥"),
                "suggestion": "è¯·æ£€æŸ¥ä»£ç è¯­æ³•é”™è¯¯"
            }
        
        # è¿è¡Œæ—¶é”™è¯¯
        run_status = result.get("run_status")
        if run_status == "Runtime Error":
            return {
                "verdict": "Runtime Error", 
                "message": result.get("error", "è¿è¡Œæ—¶é”™è¯¯"),
                "suggestion": "æ£€æŸ¥æ•°ç»„è¶Šç•Œã€ç©ºæŒ‡é’ˆç­‰é—®é¢˜"
            }
        elif run_status == "Time Limit Exceeded":
            return {
                "verdict": "Time Limit Exceeded",
                "message": f"æ‰§è¡Œæ—¶é—´: {result.get('time_used', 0)}ms",
                "suggestion": "ä¼˜åŒ–ç®—æ³•æ—¶é—´å¤æ‚åº¦"
            }
        elif run_status == "Memory Limit Exceeded":
            return {
                "verdict": "Memory Limit Exceeded", 
                "message": f"å†…å­˜ä½¿ç”¨: {result.get('memory_used', 0)}KB",
                "suggestion": "ä¼˜åŒ–å†…å­˜ä½¿ç”¨ï¼Œå‡å°‘ä¸å¿…è¦çš„æ•°æ®ç»“æ„"
            }
    
    return {
        "verdict": "Accepted",
        "time": result["time_used"],
        "memory": result["memory_used"],
        "output": result["output"]
    }
```

## æ€§èƒ½ä¼˜åŒ–å»ºè®®

### 1. ç¼“å­˜æœºåˆ¶åˆ©ç”¨
- åˆç†ä½¿ç”¨ `copyOutCached` ç¼“å­˜ç¼–è¯‘åçš„æ–‡ä»¶
- é¿å…é‡å¤ç¼–è¯‘ç›¸åŒçš„ä»£ç 

### 2. èµ„æºé™åˆ¶è®¾ç½®
- æ ¹æ®é¢˜ç›®éš¾åº¦åˆç†è®¾ç½®æ—¶é—´å’Œå†…å­˜é™åˆ¶
- ç¼–è¯‘é˜¶æ®µç»™äºˆå……è¶³çš„èµ„æºï¼ˆç‰¹åˆ«æ˜¯å†…å­˜ï¼‰

### 3. å¹¶å‘å¤„ç†
- å¤šä¸ªæµ‹è¯•ç”¨ä¾‹å¯ä»¥å¹¶è¡Œæ‰§è¡Œ
- æ³¨æ„æ§åˆ¶å¹¶å‘æ•°é‡ï¼Œé¿å…ç³»ç»Ÿè¿‡è½½

### 4. æ–‡ä»¶å¤§å°æ§åˆ¶
- åˆç†è®¾ç½® `copyOutMax` é™åˆ¶è¾“å‡ºæ–‡ä»¶å¤§å°
- é˜²æ­¢æ¶æ„ä»£ç äº§ç”Ÿå¤§é‡è¾“å‡º

## æ€»ç»“

æœ¬æŒ‡å—æä¾›äº†ä½¿ç”¨ go-judge æ²™ç®±æœåŠ¡è¿›è¡Œä»£ç åˆ¤é¢˜çš„å®Œæ•´è§£å†³æ–¹æ¡ˆï¼ŒåŒ…æ‹¬ï¼š

1. **æ¥å£è¯¦è§£**ï¼šç¼–è¯‘å’Œè¿è¡Œæ¥å£çš„å‚æ•°é…ç½®
2. **å®æˆ˜ç¤ºä¾‹**ï¼šä»¥"ä¸¤æ•°ä¹‹å’Œ"ä¸ºä¾‹çš„å®Œæ•´å®ç°
3. **å¼€å‘å·¥å…·**ï¼šPythonå®¢æˆ·ç«¯å°è£…å’Œæ‰¹é‡æµ‹è¯•
4. **é”™è¯¯å¤„ç†**ï¼šçŠ¶æ€ç è§£é‡Šå’Œå¼‚å¸¸æƒ…å†µå¤„ç†
5. **æ€§èƒ½ä¼˜åŒ–**ï¼šç¼“å­˜æœºåˆ¶å’Œèµ„æºé…ç½®å»ºè®®

é€šè¿‡æœ¬æŒ‡å—ï¼Œå¼€å‘è€…å¯ä»¥å¿«é€Ÿé›†æˆ go-judge æ²™ç®±æœåŠ¡ï¼Œæ„å»ºç¨³å®šå¯é çš„åœ¨çº¿è¯„æµ‹ç³»ç»Ÿã€‚




1. ç»Ÿä¸€æ¥å£æ–¹æ³•
æ¥å£åœ°å€: POST http://localhost:5050/run
å†…å®¹ç±»å‹: application/json
è¯´æ˜: ç¼–è¯‘å’Œè¿è¡Œéƒ½ä½¿ç”¨åŒä¸€ä¸ªæ¥å£ï¼Œé€šè¿‡ä¸åŒå‚æ•°é…ç½®å®ç°ä¸åŒåŠŸèƒ½
ç¼–è¯‘é˜¶æ®µçš„æ–¹æ³•å’Œå‚æ•°
æ ¸å¿ƒç¼–è¯‘å‚æ•°
å‚æ•°ç±»åˆ«	å‚æ•°å	ç±»å‹	å¿…å¡«	è¯´æ˜
æ‰§è¡Œå‘½ä»¤	args	[]string	æ˜¯	ç¼–è¯‘å™¨å‘½ä»¤å‚æ•°ï¼Œå¦‚ ["/usr/bin/javac", "-encoding", "UTF-8", "-cp", "/w", "Main.java"]
ç¯å¢ƒé…ç½®	env	[]string	å¦	ç¯å¢ƒå˜é‡è®¾ç½®ï¼Œå¦‚ ["PATH=/usr/bin:/bin"]
æ–‡ä»¶ç®¡ç†	copyIn	map	æ˜¯	è¾“å…¥æ–‡ä»¶æ˜ å°„ï¼Œå¦‚ {"Main.java": {"content": "æºä»£ç "}}
æ–‡ä»¶ç®¡ç†	copyOut	[]string	å¦	è¾“å‡ºæ–‡ä»¶åˆ—è¡¨ï¼Œå¦‚ ["stdout", "stderr"]
æ–‡ä»¶ç®¡ç†	copyOutCached	[]string	å¦	éœ€è¦ç¼“å­˜çš„æ–‡ä»¶ï¼Œå¦‚ ["Main.class"]
èµ„æºé™åˆ¶	cpuLimit	int64	æ˜¯	CPUæ—¶é—´é™åˆ¶(çº³ç§’)ï¼Œç¼–è¯‘é€šå¸¸è®¾ä¸º 10000000000 (10ç§’)
èµ„æºé™åˆ¶	memoryLimit	int64	æ˜¯	å†…å­˜é™åˆ¶(å­—èŠ‚)ï¼Œé€šå¸¸è®¾ä¸º 134217728 (128MB)
èµ„æºé™åˆ¶	procLimit	int	æ˜¯	è¿›ç¨‹æ•°é™åˆ¶ï¼Œé€šå¸¸è®¾ä¸º 50
è¾“å‡ºæ§åˆ¶	copyOutMax	int64	å¦	è¾“å‡ºæ–‡ä»¶å¤§å°é™åˆ¶
æ–‡ä»¶æè¿°ç¬¦é…ç½®
json
"files": [
  {"content": ""},                    // æ ‡å‡†è¾“å…¥ (ç¼–è¯‘æ—¶ä¸ºç©º)
  {"name": "stdout", "max": 10240},   // æ ‡å‡†è¾“å‡º
  {"name": "stderr", "max": 10240}    // æ ‡å‡†é”™è¯¯
]
è¿è¡Œé˜¶æ®µçš„æ–¹æ³•å’Œå‚æ•°
æ ¸å¿ƒè¿è¡Œå‚æ•°
å‚æ•°ç±»åˆ«	å‚æ•°å	ç±»å‹	å¿…å¡«	è¯´æ˜
æ‰§è¡Œå‘½ä»¤	args	[]string	æ˜¯	è¿è¡Œå‘½ä»¤å‚æ•°ï¼Œå¦‚ ["/usr/bin/java", "-cp", "/w", "Main"]
è¾“å…¥æ•°æ®	files[0].content	string	æ˜¯	æµ‹è¯•ç”¨ä¾‹è¾“å…¥æ•°æ®
æ–‡ä»¶ç®¡ç†	copyInCached	map	å¦	ä½¿ç”¨ç¼“å­˜æ–‡ä»¶ï¼Œå¦‚ {"Main.class": "file_id"}
èµ„æºé™åˆ¶	cpuLimit	int64	æ˜¯	CPUæ—¶é—´é™åˆ¶(çº³ç§’)ï¼Œè¿è¡Œé€šå¸¸è®¾ä¸º 1000000000 (1ç§’)
èµ„æºé™åˆ¶	memoryLimit	int64	æ˜¯	å†…å­˜é™åˆ¶(å­—èŠ‚)
èµ„æºé™åˆ¶	procLimit	int	æ˜¯	è¿›ç¨‹æ•°é™åˆ¶
æ²™ç®±å®‰å…¨æœºåˆ¶æä¾›çš„æ–¹æ³•
ç»“åˆç”¨æˆ·è®°å¿†ä¸­çš„å®‰å…¨æœºåˆ¶ï¼Œgo-judge æ²™ç®±æä¾›ä»¥ä¸‹å®‰å…¨é˜²æŠ¤ï¼š
1. Namespace éš”ç¦»æœºåˆ¶
PID éš”ç¦»: è¿›ç¨‹æ— æ³•çœ‹åˆ°å®¿ä¸»æœºå…¶ä»–è¿›ç¨‹
ç½‘ç»œéš”ç¦»: é˜»æ­¢ç½‘ç»œè®¿é—®
æ–‡ä»¶ç³»ç»Ÿéš”ç¦»: é™åˆ¶æ–‡ä»¶è®¿é—®èŒƒå›´
2. Cgroup èµ„æºæ§åˆ¶
CPU é™åˆ¶: é€šè¿‡ cpuLimit å‚æ•°æ§åˆ¶
å†…å­˜é™åˆ¶: é€šè¿‡ memoryLimit å‚æ•°æ§åˆ¶
è¿›ç¨‹æ•°é™åˆ¶: é€šè¿‡ procLimit å‚æ•°æ§åˆ¶
3. Seccomp ç³»ç»Ÿè°ƒç”¨è¿‡æ»¤
å±é™©è°ƒç”¨é˜»æ­¢: è‡ªåŠ¨é˜»æ­¢ ptraceã€mountã€rebootã€socket ç­‰å±é™©ç³»ç»Ÿè°ƒç”¨
ç™½åå•æœºåˆ¶: åªå…è®¸å®‰å…¨çš„ç³»ç»Ÿè°ƒç”¨æ‰§è¡Œ
å®‰å…¨å“åº”: å¯¹æ¶æ„è°ƒç”¨ç›´æ¥è¿”å›é”™è¯¯æˆ–ç»ˆæ­¢è¿›ç¨‹
è¿”å›ç»“æœå‚æ•°
ç¼–è¯‘/è¿è¡Œè¿”å›å‚æ•°
å‚æ•°å	ç±»å‹	è¯´æ˜
status	string	æ‰§è¡ŒçŠ¶æ€ (Accepted, Compile Error, Runtime Error, Time Limit Exceeded, ç­‰)
exitStatus	int	è¿›ç¨‹é€€å‡ºç  (0è¡¨ç¤ºæˆåŠŸ)
time	int64	å®é™…æ‰§è¡Œæ—¶é—´(çº³ç§’)
memory	int64	å†…å­˜å³°å€¼ä½¿ç”¨é‡(å­—èŠ‚)
runTime	int64	è¿è¡Œæ—¶é—´(çº³ç§’)
files	map	è¾“å‡ºæ–‡ä»¶å†…å®¹ (stdout, stderr)
fileIds	map	ç¼“å­˜æ–‡ä»¶IDæ˜ å°„ (ä»…ç¼–è¯‘é˜¶æ®µè¿”å›)
å®ç”¨ç¤ºä¾‹
ç¼–è¯‘è¯·æ±‚ç¤ºä¾‹
json
{
  "cmd": [{
    "args": ["/usr/bin/javac", "-encoding", "UTF-8", "-cp", "/w", "Main.java"],
    "env": ["PATH=/usr/bin:/bin"],
    "files": [
      {"content": ""},
      {"name": "stdout", "max": 10240},
      {"name": "stderr", "max": 10240}
    ],
    "cpuLimit": 10000000000,
    "memoryLimit": 134217728,
    "procLimit": 50,
    "copyIn": {"Main.java": {"content": "Javaæºä»£ç "}},
    "copyOut": ["stdout", "stderr"],
    "copyOutCached": ["Main.class"],
    "copyOutMax": 10240
  }]
}
è¿è¡Œè¯·æ±‚ç¤ºä¾‹
json
{
  "cmd": [{
    "args": ["/usr/bin/java", "-cp", "/w", "Main"],
    "env": ["PATH=/usr/bin:/bin"],
    "files": [
      {"content": "æµ‹è¯•ç”¨ä¾‹è¾“å…¥"},
      {"name": "stdout", "max": 10240},
      {"name": "stderr", "max": 10240}
    ],
    "cpuLimit": 1000000000,
    "memoryLimit": 134217728,
    "procLimit": 50,
    "copyInCached": {"Main.class": "ç¼“å­˜æ–‡ä»¶ID"},
    "copyOut": ["stdout", "stderr"],
    "copyOutMax": 10240
  }]
}
æ€»ç»“
go-judge æ²™ç®±é€šè¿‡ç»Ÿä¸€çš„ /run æ¥å£æä¾›ç¼–è¯‘å’Œè¿è¡ŒåŠŸèƒ½ï¼Œå…·å¤‡å®Œå–„çš„å‚æ•°æ§åˆ¶ä½“ç³»ï¼š
èµ„æºç®¡ç†: CPUã€å†…å­˜ã€è¿›ç¨‹æ•°çš„ç²¾ç¡®æ§åˆ¶
æ–‡ä»¶ç®¡ç†: çµæ´»çš„æ–‡ä»¶è¾“å…¥è¾“å‡ºå’Œç¼“å­˜æœºåˆ¶
å®‰å…¨é˜²æŠ¤: å¤šå±‚æ¬¡å®‰å…¨éš”ç¦»å’Œç³»ç»Ÿè°ƒç”¨è¿‡æ»¤
é”™è¯¯å¤„ç†: è¯¦ç»†çš„çŠ¶æ€ç å’Œé”™è¯¯ä¿¡æ¯è¿”å›
æ€§èƒ½ä¼˜åŒ–: ç¼–è¯‘ç»“æœç¼“å­˜å’Œå¹¶å‘æ”¯æŒ
è¿™äº›æ–¹æ³•å’Œå‚æ•°ä¸ºæ„å»ºå®‰å…¨ã€é«˜æ•ˆçš„åœ¨çº¿è¯„æµ‹ç³»ç»Ÿæä¾›äº†å¼ºå¤§çš„åŸºç¡€æ”¯æ’‘ã€‚